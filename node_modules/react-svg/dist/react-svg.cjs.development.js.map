{"version":3,"file":"react-svg.cjs.development.js","sources":["../compiled/owner-window.js","../compiled/shallow-differs.js","../compiled/ReactSVG.js"],"sourcesContent":["// Hat-tip: https://github.com/mui/material-ui/tree/master/packages/mui-utils/src.\nconst ownerWindow = (node) => {\n    const doc = node?.ownerDocument || document;\n    return doc.defaultView || window;\n};\nexport default ownerWindow;\n","// Hat-tip: https://github.com/developit/preact-compat/blob/master/src/index.js#L402.\nconst shallowDiffers = (a, b) => {\n    for (const i in a) {\n        if (!(i in b)) {\n            return true;\n        }\n    }\n    for (const i in b) {\n        if (a[i] !== b[i]) {\n            return true;\n        }\n    }\n    return false;\n};\nexport default shallowDiffers;\n","import { SVGInjector } from '@tanem/svg-injector';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport ownerWindow from './owner-window';\nimport shallowDiffers from './shallow-differs';\nconst svgNamespace = 'http://www.w3.org/2000/svg';\nconst xlinkNamespace = 'http://www.w3.org/1999/xlink';\nexport class ReactSVG extends React.Component {\n    static defaultProps = {\n        afterInjection: () => undefined,\n        beforeInjection: () => undefined,\n        evalScripts: 'never',\n        fallback: null,\n        httpRequestWithCredentials: false,\n        loading: null,\n        renumerateIRIElements: true,\n        useRequestCache: true,\n        wrapper: 'div',\n    };\n    static propTypes = {\n        afterInjection: PropTypes.func,\n        beforeInjection: PropTypes.func,\n        evalScripts: PropTypes.oneOf(['always', 'once', 'never']),\n        fallback: PropTypes.oneOfType([\n            PropTypes.func,\n            PropTypes.object,\n            PropTypes.string,\n        ]),\n        httpRequestWithCredentials: PropTypes.bool,\n        loading: PropTypes.oneOfType([\n            PropTypes.func,\n            PropTypes.object,\n            PropTypes.string,\n        ]),\n        renumerateIRIElements: PropTypes.bool,\n        src: PropTypes.string.isRequired,\n        useRequestCache: PropTypes.bool,\n        wrapper: PropTypes.oneOf(['div', 'span', 'svg']),\n    };\n    initialState = {\n        hasError: false,\n        isLoading: true,\n    };\n    state = this.initialState;\n    _isMounted = false;\n    reactWrapper;\n    nonReactWrapper;\n    refCallback = (reactWrapper) => {\n        this.reactWrapper = reactWrapper;\n    };\n    renderSVG() {\n        /* istanbul ignore else */\n        if (this.reactWrapper instanceof ownerWindow(this.reactWrapper).Node) {\n            const { beforeInjection, evalScripts, httpRequestWithCredentials, renumerateIRIElements, src, useRequestCache, } = this.props;\n            /* eslint-disable @typescript-eslint/no-non-null-assertion */\n            const afterInjection = this.props.afterInjection;\n            const wrapper = this.props.wrapper;\n            /* eslint-enable @typescript-eslint/no-non-null-assertion */\n            let nonReactWrapper;\n            let nonReactTarget;\n            if (wrapper === 'svg') {\n                nonReactWrapper = document.createElementNS(svgNamespace, wrapper);\n                nonReactWrapper.setAttribute('xmlns', svgNamespace);\n                nonReactWrapper.setAttribute('xmlns:xlink', xlinkNamespace);\n                nonReactTarget = document.createElementNS(svgNamespace, wrapper);\n            }\n            else {\n                nonReactWrapper = document.createElement(wrapper);\n                nonReactTarget = document.createElement(wrapper);\n            }\n            nonReactWrapper.appendChild(nonReactTarget);\n            nonReactTarget.dataset.src = src;\n            this.nonReactWrapper = this.reactWrapper.appendChild(nonReactWrapper);\n            const afterEach = (error, svg) => {\n                if (error) {\n                    this.removeSVG();\n                    if (!this._isMounted) {\n                        afterInjection(error);\n                        return;\n                    }\n                }\n                // TODO (Tane): It'd be better to cleanly unsubscribe from SVGInjector\n                // callbacks instead of tracking a property like this.\n                if (this._isMounted) {\n                    this.setState(() => ({\n                        hasError: !!error,\n                        isLoading: false,\n                    }), () => {\n                        afterInjection(error, svg);\n                    });\n                }\n            };\n            SVGInjector(nonReactTarget, {\n                afterEach,\n                beforeEach: beforeInjection,\n                cacheRequests: useRequestCache,\n                evalScripts,\n                httpRequestWithCredentials,\n                renumerateIRIElements,\n            });\n        }\n    }\n    removeSVG() {\n        if (this.nonReactWrapper?.parentNode) {\n            this.nonReactWrapper.parentNode.removeChild(this.nonReactWrapper);\n            this.nonReactWrapper = null;\n        }\n    }\n    componentDidMount() {\n        this._isMounted = true;\n        this.renderSVG();\n    }\n    componentDidUpdate(prevProps) {\n        if (shallowDiffers({ ...prevProps }, this.props)) {\n            this.setState(() => this.initialState, () => {\n                this.removeSVG();\n                this.renderSVG();\n            });\n        }\n    }\n    componentWillUnmount() {\n        this._isMounted = false;\n        this.removeSVG();\n    }\n    render() {\n        /* eslint-disable @typescript-eslint/no-unused-vars */\n        const { afterInjection, beforeInjection, evalScripts, fallback: Fallback, httpRequestWithCredentials, loading: Loading, renumerateIRIElements, src, useRequestCache, wrapper, ...rest } = this.props;\n        /* eslint-enable @typescript-eslint/no-unused-vars */\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const Wrapper = wrapper;\n        return (React.createElement(Wrapper, { ...rest, ref: this.refCallback, ...(wrapper === 'svg'\n                ? {\n                    xmlns: svgNamespace,\n                    xmlnsXlink: xlinkNamespace,\n                }\n                : {}) },\n            this.state.isLoading && Loading && React.createElement(Loading, null),\n            this.state.hasError && Fallback && React.createElement(Fallback, null)));\n    }\n}\n"],"names":["ownerWindow","node","doc","ownerDocument","document","defaultView","window","shallowDiffers","a","b","i","svgNamespace","xlinkNamespace","ReactSVG","initialState","hasError","isLoading","state","_isMounted","reactWrapper","nonReactWrapper","refCallback","renderSVG","Node","props","beforeInjection","evalScripts","httpRequestWithCredentials","renumerateIRIElements","src","useRequestCache","afterInjection","wrapper","nonReactTarget","createElementNS","setAttribute","createElement","appendChild","dataset","afterEach","error","svg","removeSVG","setState","SVGInjector","beforeEach","cacheRequests","parentNode","removeChild","componentDidMount","componentDidUpdate","prevProps","componentWillUnmount","render","Fallback","fallback","Loading","loading","rest","Wrapper","React","ref","xmlns","xmlnsXlink","Component","defaultProps","undefined","propTypes","PropTypes","func","oneOf","oneOfType","object","string","bool","isRequired"],"mappings":"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"}